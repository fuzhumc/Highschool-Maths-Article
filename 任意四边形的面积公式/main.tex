\documentclass{article}
\usepackage{../mathnotezh}

\title{任意四边形的面积公式}
\author{tbj}
\date{}

\begin{document}

\maketitle

\begin{thm}
    在四边形$ABCD$中,记$\lvert AB \rvert = a, \lvert BC \rvert = b, \lvert CD \rvert = c, \lvert DA \rvert = d$,
    再记半周长$p = \dfrac{a + b + c + d}{2}$.则四边形$ABCD$的面积为

    \[ \sqrt{(p - a)(p - b)(p - c)(p - d) - abcd \cos^2 \dfrac{A + C}{2}} \]
\end{thm}

\begin{proof}
    连接$B, D$,则
    
    \[Area = \dfrac{1}{2} ad \sin A + \dfrac{1}{2} bc \sin C\]

    因此

    \begin{align}
        4Area^2 & = a^2d^2 \sin^2 A + b^2c^2 \sin^2 C + 2abcd \sin A \sin C \notag \\
        & = a^2d^2 + b^2c^2 -a^2d^2 \cos^2 A - b^2c^2 \cos^2 C + 2abcd \sin A \sin C \label{1}
    \end{align}

    在$\triangle ABD, \triangle BCD$中用余弦定理得
        
    \[ a^2 + d^2 - 2ad \cos A = \lvert BD \rvert^2 = b^2 + c^2 - 2bc \cos C \]

    因此

    \[ a^2d^2 \cos^2 A + b^2c^2 \cos^2 C = \dfrac{1}{4} (a^2 + d^2 - b^2 - c^2)^2 + 2abcd \cos A \cos C \]

    代入 \eqref{1} 得

    \begin{align*}
        16Area^2 & = 4a^2d^2 + 4b^2c^2 - \left( a^2 + d^2 - b^2 - c^2 \right)^2 - 8abcd(\cos A \cos C - \sin A \sin C) \\
        & = 4a^2d^2 + 4b^2c^2 - \left( a^2 + d^2 - b^2 - c^2 \right)^2 - 8abcd \cos (A + C) \\
        & = 4a^2d^2 + 4b^2c^2 + 8abcd - \left( a^2 + d^2 - b^2 - c^2 \right)^2 - 16abcd \cos^2 \dfrac{A + C}{2} \\
        & = \left( 2ad + 2bc \right)^2 - \left( a^2 + d^2 - b^2 - c^2 \right)^2 - 16abcd \cos^2 \dfrac{A + C}{2} \\
        & = \left( 2ad + 2bc + a^2 + d^2 - b^2 - c^2 \right) \left( 2ad + 2bc - a^2 - d^2 + b^2 + c^2 \right) - 16abcd \cos^2 \dfrac{A + C}{2} \\
        & = \left( (a + d)^2 - (b - c)^2 \right) \left( (b + c)^2 - (a - d)^2 \right) - 16abcd \cos^2 \dfrac{A + C}{2} \\
        & = (a + b + c - d)(b + c + d - a)(c + d + a - b)(d + a + b - c) - 16abcd \cos^2 \dfrac{A + C}{2} \\
        & = 16(p - a)(p - b)(p - c)(p - d) - 16abcd \cos^2 \dfrac{A + C}{2} \\
        & = 16 \left( (p - a)(p - b)(p - c)(p - d) - abcd \cos^2 \dfrac{A + C}{2} \right)
    \end{align*}

    故$Area = \sqrt{(p - a)(p - b)(p - c)(p - d) - abcd \cos^2 \dfrac{A + C}{2}}$.
\end{proof}

\begin{rqq} $\ $
    \begin{enumerate}
        \item 由$A + B + C + D = 2 \pi$知$\cos^2 \dfrac{A + C}{2} = \cos^2 \dfrac{B + D}{2}$,因此还有
            \[ Area = \sqrt{(p - a)(p - b)(p - c)(p - d) - abcd \cos^2 \dfrac{B + D}{2}} \]
        \item $Area$的最大值为$\sqrt{(p - a)(p - b)(p - c)(p - d)}$,当且仅当$A, B, C, D$四点共圆时取等.
    \end{enumerate}
\end{rqq}

\end{document}